# Acceptance Criteria for `x86-alignment-check` (EARS format)

## System: `x86-alignment-check` library

### Ubiquitous Language

*   **AC flag**: Alignment Check flag in the `eflags`/`rflags` register.
*   **The system**: The `x86-alignment-check` library.

### Event-Driven Requirements

**AC-1: `x86_alignment_check` with `true`**
*   **Event:** The `x86_alignment_check` function is called with `true`.
*   **Condition:** If the target architecture is `x86` or `x86_64`.
*   **System Response:** The system shall enable the AC flag and return the previous state of the AC flag.

**AC-2: `x86_alignment_check` with `false`**
*   **Event:** The `x86_alignment_check` function is called with `false`.
*   **Condition:** If the target architecture is `x86` or `x86_64`.
*   **System Response:** The system shall disable the AC flag and return the previous state of the AC flag.

**AC-3: `ac_call_once`**
*   **Event:** The `ac_call_once` function is called.
*   **Condition:** If the target architecture is `x86` or `x86_64`.
*   **System Response:** The system shall enable the AC flag, execute the provided closure, restore the original AC flag state, and return the closure's result.

**AC-4: `no_ac_call_once`**
*   **Event:** The `no_ac_call_once` function is called.
*   **Condition:** If the target architecture is `x86` or `x86_64`.
*   **System Response:** The system shall disable the AC flag, execute the provided closure, restore the original AC flag state, and return the closure's result.

### State-Driven Requirements

**AC-5: `no_std` compatibility**
*   **State:** When the system is compiled.
*   **System Response:** It shall be compatible with `#![no_std]`.

**AC-6: Non-x86/x86_64 architecture**
*   **State:** When the system is compiled for a non-`x86`/`x86_64` architecture.
*   **System Response:** The alignment check functions shall not be available.

### Optional Features (Undesired Events)

**AC-7: Unaligned memory access**
*   **Event:** If unaligned memory access occurs while the AC flag is enabled.
*   **System Response:** The system should trigger a `SIGBUS` signal. (This is tested with an ignored test case).