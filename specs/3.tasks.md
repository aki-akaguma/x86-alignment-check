# Development Tasks for `x86-alignment-check`

This checklist is based on the design specified in `specs/2.design.md`. All tasks are marked as complete as the implementation already exists in `src/lib.rs`.

## Core Setup

- [x] Initialize the crate with `#![no_std]` for `no_std` compatibility.

## Architecture-Specific Implementation

- [x] Use `#[cfg]` attributes to conditionally compile code for `x86` and `x86_64` architectures.

## Components

### Constants and Helper Functions

- [x] Define the `EFLAGS_AC_BIT` constant for `x86` (`u32`).
- [x] Define the `EFLAGS_AC_BIT` constant for `x86_64` (`u64`).
- [x] Implement `unsafe fn __read_eflags()` for `x86` using inline assembly.
- [x] Implement `unsafe fn __write_eflags()` for `x86` using inline assembly.
- [x] Implement `unsafe fn __read_eflags()` for `x86_64` using inline assembly.
- [x] Implement `unsafe fn __write_eflags()` for `x86_64` using inline assembly.

### Public API

- [x] Implement the public function `x86_alignment_check(b: bool) -> bool`.
- [x] Implement the public function `ac_call_once<F, T>(f: F) -> T`.
- [x] Implement the public function `no_ac_call_once<F, T>(f: F) -> T`.

## Testing

- [x] Create a `#[cfg(test)]` module.
- [x] Implement `it_works_0` to test the core functionality of `x86_alignment_check`.
- [x] Implement `it_works_1` to test `ac_call_once`.
- [x] Implement `it_works_2` to test `no_ac_call_once`.
- [x] Implement `it_works_3` to test nested calls.
- [x] Implement `it_works_ignore_0` to demonstrate a `SIGBUS` fault and mark it with `#[ignore]`.
